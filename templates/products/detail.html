{% extends 'base/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{{ product.title }} - {% trans "Minimalist Marketplace" %}{% endblock %}

{% block meta_description %}{{ product.meta_description|default:product.short_description }}{% endblock %}

{% block content %}
<div class="bg-gray-50 min-h-screen py-8">
    <div class="max-w-7xl mx-auto px-4">
        
        <!-- Breadcrumb -->
        <nav class="mb-8">
            <ol class="flex items-center space-x-2 text-sm text-gray-600">
                <li><a href="{% url 'home' %}" class="hover:text-blue-600">{% trans "Home" %}</a></li>
                <li><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/></svg></li>
                <li><a href="{% url 'products:list' %}" class="hover:text-blue-600">{% trans "Products" %}</a></li>
                <li><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/></svg></li>
                <li><a href="{% url 'products:category' product.category.slug %}" class="hover:text-blue-600">{{ product.category.name }}</a></li>
                <li><svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd"/></svg></li>
                <li class="text-gray-900 font-medium truncate max-w-xs">{{ product.title }}</li>
            </ol>
        </nav>

        <!-- Product Main Content -->
        <div class="bg-white rounded-lg shadow-sm overflow-hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 p-8">
                
                <!-- Left Column: Product Images -->
                <div class="space-y-4">
                    <!-- Main Image -->
                    <div class="aspect-square bg-gray-100 rounded-lg overflow-hidden">
                        {% if product.main_image %}
                            <img id="mainImage" src="{{ product.main_image.image.url }}" alt="{{ product.title }}" class="w-full h-full object-contain">
                        {% else %}
                            <div class="w-full h-full flex items-center justify-center">
                                <svg class="w-32 h-32 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                                </svg>
                            </div>
                        {% endif %}
                    </div>

                    <!-- Thumbnail Gallery -->
                    {% if product.images.all %}
                    <div class="grid grid-cols-5 gap-2">
                        {% for image in product.images.all %}
                        <button onclick="changeImage('{{ image.image.url }}')" class="aspect-square bg-gray-100 rounded-lg overflow-hidden border-2 hover:border-blue-500 transition-colors">
                            <img src="{{ image.image.url }}" alt="{{ product.title }}" class="w-full h-full object-cover">
                        </button>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <!-- Right Column: Product Info -->
                <div class="flex flex-col space-y-6">
                    
                    <!-- Product Title -->
                    <div>
                        <h1 class="text-3xl font-bold text-gray-900 mb-2">{{ product.title }}</h1>
                        <p class="text-gray-600">{{ product.short_description }}</p>
                    </div>

                    <!-- Rating & Reviews -->
                    <div class="flex items-center space-x-4">
                        <div class="flex items-center">
                            {% for i in "12345" %}
                                {% if forloop.counter <= product.rating %}
                                <svg class="w-5 h-5 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                                </svg>
                                {% else %}
                                <svg class="w-5 h-5 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                                </svg>
                                {% endif %}
                            {% endfor %}
                            <span class="ml-2 text-sm font-medium text-gray-900">{{ product.rating|default:"0.0" }}</span>
                        </div>
                        <span class="text-gray-400">|</span>
                        <a href="#reviews" class="text-sm text-blue-600 hover:text-blue-800">{{ product.review_count }} {% trans "reviews" %}</a>
                        <span class="text-gray-400">|</span>
                        <span class="text-sm text-gray-600">{{ product.view_count }} {% trans "views" %}</span>
                    </div>

                    <!-- Price -->
                    <div class="border-t border-b py-4">
                        <div class="flex items-baseline space-x-3">
                            <span class="text-4xl font-bold text-gray-900">${{ product.price }}</span>
                            {% if product.old_price and product.old_price > product.price %}
                            <span class="text-xl text-gray-500 line-through">${{ product.old_price }}</span>
                            <span class="px-2 py-1 bg-red-100 text-red-800 text-sm font-semibold rounded">
                                {{ product.discount_percentage }}% {% trans "OFF" %}
                            </span>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Stock Status -->
                    <div>
                        {% if product.is_in_stock %}
                            {% if product.stock_quantity <= 5 %}
                            <p class="text-orange-600 font-medium">⚠️ {% trans "Only" %} {{ product.stock_quantity }} {% trans "left in stock" %}</p>
                            {% else %}
                            <p class="text-green-600 font-medium">✓ {% trans "In Stock" %} ({{ product.stock_quantity }} {% trans "available" %})</p>
                            {% endif %}
                        {% else %}
                        <p class="text-red-600 font-medium">✗ {% trans "Out of Stock" %}</p>
                        {% endif %}
                    </div>

                    <!-- Seller Info -->
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <p class="text-sm text-gray-600 mb-2">{% trans "Sold by" %}</p>
                        <div class="flex items-center justify-between">
                            <a href="{% url 'sellers:store_detail' product.seller.store_slug %}" class="flex items-center space-x-3 group">
                                {% if product.seller.logo %}
                                <img src="{{ product.seller.logo.url }}" alt="{{ product.seller.store_name }}" class="w-12 h-12 rounded-full object-cover">
                                {% else %}
                                <div class="w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold">
                                    {{ product.seller.store_name|first|upper }}
                                </div>
                                {% endif %}
                                <div>
                                    <h3 class="font-semibold text-gray-900 group-hover:text-blue-600">{{ product.seller.store_name }}</h3>
                                    <div class="flex items-center text-sm">
                                        <span class="text-yellow-400">★</span>
                                        <span class="ml-1 text-gray-600">{{ product.seller.rating|default:"0.0" }}</span>
                                    </div>
                                </div>
                            </a>
                            <a href="{% url 'sellers:store_detail' product.seller.store_slug %}" class="text-sm text-blue-600 hover:text-blue-800">
                                {% trans "Visit Store" %} →
                            </a>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div class="space-y-3">
                        {% if product.is_in_stock %}
                        <button onclick="addToCart({{ product.id }})" class="w-full bg-blue-600 text-white py-4 rounded-lg font-semibold hover:bg-blue-700 transition-colors flex items-center justify-center space-x-2">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                            <span>{% trans "Add to Cart" %}</span>
                        </button>
                        {% else %}
                        <button disabled class="w-full bg-gray-300 text-gray-500 py-4 rounded-lg font-semibold cursor-not-allowed">
                            {% trans "Out of Stock" %}
                        </button>
                        {% endif %}

                        <button onclick="toggleWishlist({{ product.id }}, this)" class="w-full border-2 border-gray-300 text-gray-700 py-4 rounded-lg font-semibold hover:border-blue-500 hover:text-blue-600 transition-colors flex items-center justify-center space-x-2">
                            {% if is_in_wishlist %}
                            <svg class="w-6 h-6 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/>
                            </svg>
                            <span>{% trans "In Wishlist" %}</span>
                            {% else %}
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>
                            <span>{% trans "Add to Wishlist" %}</span>
                            {% endif %}
                        </button>
                    </div>

                    <!-- Product Details -->
                    <div class="border-t pt-6 space-y-3">
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">{% trans "SKU:" %}</span>
                            <span class="font-medium">{{ product.sku|default:"-" }}</span>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">{% trans "Category:" %}</span>
                            <a href="{% url 'products:category' product.category.slug %}" class="font-medium text-blue-600 hover:text-blue-800">{{ product.category.name }}</a>
                        </div>
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">{% trans "Condition:" %}</span>
                            <span class="font-medium">{{ product.get_condition_display }}</span>
                        </div>
                        {% if product.brand %}
                        <div class="flex justify-between text-sm">
                            <span class="text-gray-600">{% trans "Brand:" %}</span>
                            <span class="font-medium">{{ product.brand }}</span>
                        </div>
                        {% endif %}
                    </div>
                </div>
            </div>

            <!-- Product Description & Details Tabs -->
            <div class="border-t">
                <div class="max-w-5xl mx-auto px-8 py-8">
                    <!-- Tabs -->
                    <div class="border-b mb-8">
                        <nav class="flex space-x-8">
                            <button onclick="showTab('description')" id="tab-description" class="tab-button active py-4 px-1 border-b-2 font-medium text-sm">
                                {% trans "Description" %}
                            </button>
                            <button onclick="showTab('specifications')" id="tab-specifications" class="tab-button py-4 px-1 border-b-2 font-medium text-sm">
                                {% trans "Specifications" %}
                            </button>
                            <button onclick="showTab('reviews')" id="tab-reviews" class="tab-button py-4 px-1 border-b-2 font-medium text-sm">
                                {% trans "Reviews" %} ({{ product.review_count }})
                            </button>
                        </nav>
                    </div>

                    <!-- Tab Content: Description -->
                    <div id="content-description" class="tab-content">
                        <div class="prose max-w-none">
                            {{ product.description|linebreaks }}
                        </div>
                    </div>

                    <!-- Tab Content: Specifications -->
                    <div id="content-specifications" class="tab-content hidden">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            {% if product.weight %}
                            <div class="flex justify-between border-b pb-3">
                                <span class="text-gray-600">{% trans "Weight" %}</span>
                                <span class="font-medium">{{ product.weight }} kg</span>
                            </div>
                            {% endif %}
                            {% if product.dimensions %}
                            <div class="flex justify-between border-b pb-3">
                                <span class="text-gray-600">{% trans "Dimensions" %}</span>
                                <span class="font-medium">{{ product.dimensions }}</span>
                            </div>
                            {% endif %}
                            {% for key, value in product.attributes.items %}
                            <div class="flex justify-between border-b pb-3">
                                <span class="text-gray-600">{{ key|title }}</span>
                                <span class="font-medium">{{ value }}</span>
                            </div>
                            {% endfor %}
                        </div>
                    </div>

                    <!-- Tab Content: Reviews -->
                    <div id="content-reviews" class="tab-content hidden">
                        <div id="reviews" class="space-y-6">
                            {% if reviews %}
                                {% for review in reviews %}
                                <div class="border-b pb-6">
                                    <div class="flex items-start space-x-4">
                                        <div class="flex-shrink-0">
                                            <div class="w-12 h-12 rounded-full bg-blue-500 flex items-center justify-center text-white font-bold">
                                                {{ review.user.username|first|upper }}
                                            </div>
                                        </div>
                                        <div class="flex-1">
                                            <div class="flex items-center justify-between">
                                                <h4 class="font-semibold">{{ review.user.username }}</h4>
                                                <span class="text-sm text-gray-500">{{ review.created_at|date:"M d, Y" }}</span>
                                            </div>
                                            <div class="flex items-center mt-1">
                                                {% for i in "12345" %}
                                                    {% if forloop.counter <= review.rating %}
                                                    <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                                                    </svg>
                                                    {% else %}
                                                    <svg class="w-4 h-4 text-gray-300" fill="currentColor" viewBox="0 0 20 20">
                                                        <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                                                    </svg>
                                                    {% endif %}
                                                {% endfor %}
                                                {% if review.is_verified_purchase %}
                                                <span class="ml-2 text-xs text-green-600 font-medium">✓ {% trans "Verified Purchase" %}</span>
                                                {% endif %}
                                            </div>
                                            {% if review.title %}
                                            <h5 class="font-medium mt-2">{{ review.title }}</h5>
                                            {% endif %}
                                            <p class="text-gray-700 mt-2">{{ review.comment }}</p>
                                        </div>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                            <div class="text-center py-12">
                                <svg class="mx-auto h-12 w-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 8h10M7 12h4m1 8l-4-4H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-3l-4 4z"/>
                                </svg>
                                <p class="mt-4 text-gray-600">{% trans "No reviews yet. Be the first to review this product!" %}</p>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Related Products -->
        {% if related_products %}
        <div class="mt-12">
            <h2 class="text-2xl font-bold mb-6">{% trans "Related Products" %}</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-5 gap-4">
                {% for related in related_products %}
                <a href="{% url 'products:detail' related.slug %}" class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4">
                    {% if related.main_image %}
                    <img src="{{ related.main_image.image.url }}" alt="{{ related.title }}" class="w-full h-40 object-contain mb-3">
                    {% else %}
                    <div class="w-full h-40 bg-gray-200 flex items-center justify-center mb-3 rounded">
                        <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    {% endif %}
                    <h3 class="font-medium text-sm line-clamp-2 mb-2">{{ related.title }}</h3>
                    <p class="text-blue-600 font-bold">${{ related.price }}</p>
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}

        <!-- Seller's Other Products -->
        {% if seller_products %}
        <div class="mt-12">
            <h2 class="text-2xl font-bold mb-6">{% trans "More from" %} {{ product.seller.store_name }}</h2>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                {% for seller_product in seller_products %}
                <a href="{% url 'products:detail' seller_product.slug %}" class="bg-white rounded-lg shadow-sm hover:shadow-md transition-shadow p-4">
                    {% if seller_product.main_image %}
                    <img src="{{ seller_product.main_image.image.url }}" alt="{{ seller_product.title }}" class="w-full h-40 object-contain mb-3">
                    {% else %}
                    <div class="w-full h-40 bg-gray-200 flex items-center justify-center mb-3 rounded">
                        <svg class="w-12 h-12 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"/>
                        </svg>
                    </div>
                    {% endif %}
                    <h3 class="font-medium text-sm line-clamp-2 mb-2">{{ seller_product.title }}</h3>
                    <p class="text-blue-600 font-bold">${{ seller_product.price }}</p>
                </a>
                {% endfor %}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<script>
// Image Gallery
function changeImage(imageUrl) {
    document.getElementById('mainImage').src = imageUrl;
}

// Tabs
function showTab(tabName) {
    // Hide all tab contents
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.add('hidden');
    });
    
    // Remove active class from all buttons
    document.querySelectorAll('.tab-button').forEach(button => {
        button.classList.remove('active', 'border-blue-500', 'text-blue-600');
        button.classList.add('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
    });
    
    // Show selected tab content
    document.getElementById(`content-${tabName}`).classList.remove('hidden');
    
    // Add active class to selected button
    const activeButton = document.getElementById(`tab-${tabName}`);
    activeButton.classList.add('active', 'border-blue-500', 'text-blue-600');
    activeButton.classList.remove('border-transparent', 'text-gray-500', 'hover:text-gray-700', 'hover:border-gray-300');
}

// CSRF Token
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

const csrftoken = getCookie('csrftoken');

// Add to Cart
function addToCart(productId) {
    console.log('Add to cart:', productId);
    showToast('{% trans "Add to cart functionality coming soon!" %}', 'info');
}

// Toggle Wishlist
function toggleWishlist(productId, button) {
    const isInWishlist = button.querySelector('svg').getAttribute('fill') === 'currentColor';
    
    if (isInWishlist) {
        removeFromWishlist(productId, button);
    } else {
        addToWishlist(productId, button);
    }
}

function addToWishlist(productId, button) {
    fetch(`/users/wishlist/add/${productId}/`, {
        method: 'POST',
        headers: { 'X-CSRFToken': csrftoken }
    })
    .then(response => response.text())
    .then(() => {
        button.innerHTML = `
            <svg class="w-6 h-6 text-red-500" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M3.172 5.172a4 4 0 015.656 0L10 6.343l1.172-1.171a4 4 0 115.656 5.656L10 17.657l-6.828-6.829a4 4 0 010-5.656z" clip-rule="evenodd"/>
            </svg>
            <span>{% trans "In Wishlist" %}</span>
        `;
        showToast('{% trans "Added to wishlist!" %}', 'success');
    })
    .catch(error => {
        console.error('Error:', error);
        showToast('{% trans "Failed to add to wishlist" %}', 'error');
    });
}

function removeFromWishlist(productId, button) {
    fetch(`/users/wishlist/remove/${productId}/`, {
        method: 'POST',
        headers: { 'X-CSRFToken': csrftoken }
    })
    .then(response => response.text())
    .then(() => {
        button.innerHTML = `
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
            </svg>
            <span>{% trans "Add to Wishlist" %}</span>
        `;
        showToast('{% trans "Removed from wishlist!" %}', 'success');
    })
    .catch(error => {
        console.error('Error:', error);
        showToast('{% trans "Failed to remove from wishlist" %}', 'error');
    });
}

// Toast Notifications
function showToast(message, type = 'info') {
    const existingToasts = document.querySelectorAll('.toast-notification');
    existingToasts.forEach(toast => toast.remove());
    
    const toast = document.createElement('div');
    toast.className = 'toast-notification fixed top-4 right-4 z-50 px-6 py-3 rounded-lg shadow-lg text-white';
    
    const colors = {
        success: 'bg-green-500',
        error: 'bg-red-500',
        info: 'bg-blue-500'
    };
    
    toast.classList.add(colors[type] || colors.info);
    toast.textContent = message;
    
    document.body.appendChild(toast);
    setTimeout(() => toast.remove(), 3000);
}
</script>

<style>
.tab-button {
    transition: all 0.2s;
}

.tab-button.active {
    border-color: #3B82F6;
    color: #3B82F6;
}
</style>
{% endblock %}