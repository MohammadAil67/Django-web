{% extends 'base/base.html' %}
{% load static %}
{% load i18n %}

{% block title %}{% trans "My Profile" %}{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 py-8">
    <!-- Header -->
    <div class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">{% trans "My Profile" %}</h1>
        <p class="text-gray-600 mt-2">{% trans "Manage your account settings and preferences" %}</p>
    </div>

    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
        <!-- Profile Card -->
        <div class="lg:col-span-1">
            <div class="bg-white rounded-lg shadow-sm p-6">
                <!-- Profile Image -->
                <div class="text-center mb-6">
                    {% if user.profile_image %}
                        <img src="{{ user.profile_image.url }}" alt="{{ user.username }}" class="w-32 h-32 rounded-full mx-auto object-cover border-4 border-gray-200">
                    {% else %}
                        <div class="w-32 h-32 rounded-full mx-auto bg-blue-100 flex items-center justify-center">
                            <span class="text-4xl font-bold text-blue-600">{{ user.username.0|upper }}</span>
                        </div>
                    {% endif %}
                    
                    <h2 class="mt-4 text-xl font-bold text-gray-900">
                        {{ user.get_full_name|default:user.username }}
                    </h2>
                    <p class="text-gray-600">@{{ user.username }}</p>
                    
                    {% if user.role == 'seller' %}
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-blue-100 text-blue-800 mt-2">
                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M9 2a1 1 0 000 2h2a1 1 0 100-2H9z"/>
                                <path fill-rule="evenodd" d="M4 5a2 2 0 012-2 3 3 0 003 3h2a3 3 0 003-3 2 2 0 012 2v11a2 2 0 01-2 2H6a2 2 0 01-2-2V5zm3 4a1 1 0 000 2h.01a1 1 0 100-2H7zm3 0a1 1 0 000 2h3a1 1 0 100-2h-3zm-3 4a1 1 0 100 2h.01a1 1 0 100-2H7zm3 0a1 1 0 100 2h3a1 1 0 100-2h-3z" clip-rule="evenodd"/>
                            </svg>
                            {% trans "Seller" %}
                        </span>
                    {% else %}
                        <span class="inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800 mt-2">
                            <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                            </svg>
                            {% trans "Buyer" %}
                        </span>
                    {% endif %}
                </div>

                <!-- Quick Stats -->
                <div class="border-t pt-4 space-y-3">
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">{% trans "Wishlist Items" %}</span>
                        <span class="font-semibold text-gray-900">{{ wishlist_count }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">{% trans "Following Stores" %}</span>
                        <span class="font-semibold text-gray-900">{{ following_count }}</span>
                    </div>
                    
                    {% if user.role == 'seller' %}
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">{% trans "Products" %}</span>
                        <span class="font-semibold text-gray-900">{{ product_count }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">{% trans "Total Sales" %}</span>
                        <span class="font-semibold text-gray-900">{{ total_sales }}</span>
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-gray-600">{% trans "Followers" %}</span>
                        <span class="font-semibold text-gray-900">{{ follower_count }}</span>
                    </div>
                    {% endif %}
                </div>

                <!-- Action Button -->
                <div class="mt-6">
                    <a href="{% url 'users:profile_edit' %}" class="w-full inline-flex justify-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700">
                        {% trans "Edit Profile" %}
                    </a>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="lg:col-span-2">
            <!-- Personal Information -->
            <div class="bg-white rounded-lg shadow-sm p-6 mb-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">{% trans "Personal Information" %}</h3>
                
                <dl class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <dt class="text-sm font-medium text-gray-500">{% trans "Email" %}</dt>
                        <dd class="mt-1 text-sm text-gray-900">{{ user.email }}</dd>
                    </div>
                    
                    <div>
                        <dt class="text-sm font-medium text-gray-500">{% trans "Phone" %}</dt>
                        <dd class="mt-1 text-sm text-gray-900">{{ user.phone_number|default:"Not provided" }}</dd>
                    </div>
                    
                    <div>
                        <dt class="text-sm font-medium text-gray-500">{% trans "Language" %}</dt>
                        <dd class="mt-1 text-sm text-gray-900">{{ user.get_preferred_language_display }}</dd>
                    </div>
                    
                    <div>
                        <dt class="text-sm font-medium text-gray-500">{% trans "Member Since" %}</dt>
                        <dd class="mt-1 text-sm text-gray-900">{{ user.date_joined|date:"F d, Y" }}</dd>
                    </div>
                </dl>
            </div>

            <!-- Quick Links -->
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <a href="{% url 'users:wishlist' %}" class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-all">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-red-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-medium text-gray-900">{% trans "My Wishlist" %}</h4>
                            <p class="text-sm text-gray-500">{{ wishlist_count }} {% trans "items" %}</p>
                        </div>
                    </div>
                </a>

                {% if user.role == 'seller' %}
                <a href="{% url 'sellers:dashboard' %}" class="bg-white rounded-lg shadow-sm p-6 hover:shadow-md transition-all">
                    <div class="flex items-center">
                        <div class="flex-shrink-0">
                            <svg class="h-8 w-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4M7 13L5.4 5M7 13l-2.293 2.293c-.63.63-.184 1.707.707 1.707H17m0 0a2 2 0 100 4 2 2 0 000-4zm-8 2a2 2 0 11-4 0 2 2 0 014 0z"/>
                            </svg>
                        </div>
                        <div class="ml-4">
                            <h4 class="text-lg font-medium text-gray-900">{% trans "Seller Dashboard" %}</h4>
                            <p class="text-sm text-gray-500">{% trans "Manage your store" %}</p>
                        </div>
                    </div>
                </a>
                {% endif %}
            </div>

            <!-- Settings -->
            <div class="bg-white rounded-lg shadow-sm p-6 mt-6">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">{% trans "Account Settings" %}</h3>
                
                <div class="space-y-3">
                    <a href="{% url 'users:profile_edit' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50">
                        <span class="text-sm text-gray-700">{% trans "Edit Profile" %}</span>
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </a>
                    
                    <a href="{% url 'users:password_reset' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50">
                        <span class="text-sm text-gray-700">{% trans "Change Password" %}</span>
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
                        </svg>
                    </a>
                    
                    <form method="post" action="{% url 'users:logout' %}" class="flex items-center justify-between p-3 rounded-lg hover:bg-gray-50">
                        {% csrf_token %}
                        <button type="submit" class="text-sm text-red-600 hover:text-red-700 w-full text-left">
                            {% trans "Logout" %}
                        </button>
                        <svg class="w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"/>
                        </svg>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}